directus_users:
  type: collection
  fields:
    is_admin:
      type: boolean
      note: "Is the user an admin?"

    last_opened:
      type: string
      length: 512
      note: "Last opened chat or signup step. Example: /chats/1234, /signup/step-3"

    last_online_timestamp:
      type: string
      length: 256
      note: "Timestamp of the last time the user was online"

    darkmode:
      type: boolean
      note: "Is dark mode enabled?"

    encrypted_email_address:
      type: string
      length: 512
      note: "Encrypted email address"

    encrypted_username:
      type: string
      length: 512
      note: "Encrypted username"

    encrypted_profileimage_url:
      type: string
      length: 512
      note: "Encrypted profile image URL"

    encrypted_credit_balance:
      type: string
      length: 512
      note: "Encrypted credit balance"

    encrypted_gifted_credits_for_signup:
      type: string
      length: 512
      note: "Encrypted gifted credits for signup"

    encrypted_invoice_counter:
      type: string
      length: 512
      note: "Encrypted counter for user's invoices (starts at 0)"

    encrypted_settings:
      type: textfield
      note: "Encrypted user preferences"

    connected_devices:
      type: json
      note: "A JSON array of known device hashes for the user."

    vault_key_id:
      type: string
      length: 64
      note: "Reference to the user's encryption key in Vault"

    vault_key_version:
      type: string
      length: 64
      note: "Version of the user's encryption key in Vault"

    api_key_hash:
      type: string
      length: 128
      note: "Hashed API key for developer access"

    encrypted_tfa_secret:
      type: string
      length: 512
      note: "Encrypted 2FA secret key"

    tfa_backup_codes_hashes:
      type: textfield
      note: "Array of Argon2 hashed backup codes"

    encrypted_tfa_app_name:
      type: string
      length: 256
      note: "Encrypted name of the 2FA app used by the user"

    tfa_last_used:
      type: string
      length: 256
      note: "Timestamp of when 2FA was last successfully used"
    
    consent_tfa_safely_stored_timestamp:
      type: string
      length: 256
      note: "Timestamp of when the user consented to store 2FA safely"
      
    hashed_email:
      type: string
      length: 256
      note: "SHA-256 hash of the email address for user lookup during login"
      
    lookup_hashes:
      type: json
      note: "Array of SHA-256 hashes of email+login_secret for zero-knowledge authentication across different login methods"

    consent_privacy_and_apps_default_settings:
      type: string
      length: 256
      note: "Timestamp of when the user consented to default privacy and app settings"

    consent_mates_default_settings:
      type: string
      length: 256
      note: "Timestamp of when the user consented to default mates settings"
