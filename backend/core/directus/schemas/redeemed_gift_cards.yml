# backend/core/directus/schemas/redeemed_gift_cards.yml
# Defines the schema for the 'redeemed_gift_cards' collection in Directus.
# This collection tracks which users have redeemed which gift cards, preserving
# redemption history even after the gift card itself is deleted.
redeemed_gift_cards:
  type: collection
  fields:
    id:
      type: uuid
      primary: true
      note: "Primary Key - Unique identifier for the redemption record, auto-generated by Directus."
      
    encrypted_gift_card_code:
      type: string
      length: 512
      note: "Encrypted gift card code that was redeemed (stored for historical record, encrypted with user's vault key)."
      
    user_id_hash:
      type: string
      length: 512
      note: "Hash of the user ID who redeemed this gift card"
      
    credits_value:
      type: integer
      note: "Value of credits that were added to the user's account from this redemption."
      
    redeemed_at:
      type: datetime
      note: "Timestamp when the gift card was redeemed. Auto-generated by Directus."
      
    gift_card_id:
      type: uuid
      nullable: true
      note: "Reference to the original gift card ID (if still available). May be null if gift card was deleted."
