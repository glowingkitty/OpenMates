# This file defines the schema for the 'Drafts' collection in Directus.
# It stores user-specific drafts for chats.
drafts:
  type: collection
  fields:
    id: # draft_id
      type: uuid
      note: "Primary Key - Unique identifier for the draft (e.g., UUID)"

    # Foreign key to the Chats collection
    chat_id:
      type: string
      note: "Foreign Key - Identifier of the chat this draft belongs to"
      # In Directus, you would set up a relationship to the 'chats' collection.

    # Foreign key to the Users collection (or however users are identified)
    # Assuming consistency with chats.yml, using hashed_user_id
    hashed_user_id:
      type: string
      note: "Foreign Key - [Hashed] Identifier of the user this draft belongs to"
  
    encrypted_content:
      type: textfield # Suitable for JSON string
      note: "[Encrypted using user-specific key, Nullable] Tiptap JSON string representing the user's unsent draft message. Null if no draft or cleared."

    version:
      type: integer
      note: "Version number of this specific draft for this user and chat"

    created_at:
      type: integer
      note: "Unix timestamp (seconds) when the draft record was first created"

    updated_at:
      type: integer
      note: "Unix timestamp (seconds) of the last update to this draft record (covers last edit)"