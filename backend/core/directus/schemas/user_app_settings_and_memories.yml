# File: backend/core/directus/schemas/user_app_settings_and_memories.yml
# Description: Defines the schema for the 'user_app_settings_and_memories' collection in Directus.
# This collection stores user-specific configurations and memories for different apps.

user_app_settings_and_memories:
  type: collection
  fields:
    id:
      type: uuid
      primary: true
      note: "Primary Key - Unique identifier for the entry, auto-generated by Directus."

    user_id_hash:
      type: string
      length: 255
      note: "[Indexed] Hashed identifier of the user this entry belongs to."
      # In Directus, consider adding an index to this field.

    app_id:
      type: string
      length: 100
      note: "[Indexed] Identifier of the app this entry is associated with (e.g., 'ai', 'travel', 'health')."
      # In Directus, consider adding an index to this field.

    item_key:
      type: string
      length: 255
      note: "[Indexed] The specific key for this piece of setting or memory within the app (e.g., 'preferences', 'api_keys', 'upcoming_trips')."
      # In Directus, consider adding an index to this field.

    encrypted_item_value_json:
      type: textfield # Suitable for potentially large JSON strings or other text data
      note: "[Encrypted] The actual setting or memory content, stored as an encrypted JSON string using the user's Vault key. Structure might be defined by app.yml or be a simple value."
      nullable: true # Value can be explicitly null or not set

    created_at:
      type: integer 
      note: "Unix timestamp (seconds) when this entry was first created. Application should provide this."

    updated_at:
      type: integer
      note: "Unix timestamp (seconds) when this entry was last updated. Application should provide this."