invoices:
  type: collection
  fields:
    id:
      type: uuid
      primary: true
      
    order_id:
      type: string
      length: 255
      note: "The order ID from the payment provider"

    user_id_hash:
      type: string
      length: 512
      note: "Hash of the user ID who made the purchase"
      
    date:
      type: datetime
      
    encrypted_amount:
      type: string
      length: 512
      note: "Encrypted invoice amount"
      
    encrypted_s3_object_key:
      type: string
      length: 512
      note: "Encrypted S3 object key for the invoice"

    encrypted_aes_key:
      type: string
      length: 512
      note: "Encrypted AES key for the invoice"

    aes_nonce:
      type: string
      length: 512
      note: "Nonce used for AES encryption"
      
    encrypted_credits_purchased:
      type: string
      length: 512
      note: "Encrypted number of credits this invoice was for"
      
    encrypted_filename:
      type: string
      length: 512
      note: "Encrypted filename of the invoice"

    has_chargeback:
      type: boolean
      note: "Whether this invoice had a chargeback/dispute"
      default: false

    chargeback_date:
      type: string
      length: 256
      nullable: true
      note: "ISO timestamp when chargeback/dispute was created"
