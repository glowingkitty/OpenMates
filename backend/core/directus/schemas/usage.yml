usage:
  type: collection
  fields:
    id:
      type: uuid
      primary: true
      
    user_id_hash: # Changed from user_id
      type: string  # Changed from uuid
      length: 255 # Assuming a reasonable length for a hash
      note: "[Indexed] Hashed identifier of the user this usage entry belongs to."

    encrypted_app_id:
      type: string
      length: 512
      note: "[Encrypted] App identifier, encrypted with user vault key for privacy"
      
    encrypted_skill_id:
      type: string
      length: 512
      note: "[Encrypted] Skill identifier, encrypted with user vault key for privacy"
      
    type:
      type: string
      length: 512
      note: "Type of usage: chat_message, api_call, etc."
      
    hashed_chat_id:
      type: string
      length: 64
      note: "[Indexed] SHA-256 hash of chat_id (for linking, but not reversible to protect privacy)"
      
    hashed_message_id:
      type: string
      length: 64
      note: "[Indexed] SHA-256 hash of message_id (for linking, but not reversible to protect privacy)"

    encrypted_model_used:
      type: string
      length: 512
      note: "[Encrypted] Model identifier, encrypted with user vault key for privacy"

    encrypted_credits_costs_total:
      type: string
      length: 512
      note: "Encrypted total credit costs for the request."

    encrypted_input_tokens:
      type: string
      length: 512
      note: "Encrypted input tokens (all systemprompt + chat history) used, if applicable."

    encrypted_output_tokens:
      type: string
      length: 512
      note: "Encrypted output tokens used for the response, if applicable."
      
    created_at:
      type: integer 
      note: "Unix timestamp (seconds) when this usage entry was first created. Application should provide this."

    updated_at:
      type: integer
      note: "Unix timestamp (seconds) when this usage entry was last updated. Application should provide this."