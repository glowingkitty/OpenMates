<mjml>
  <mj-head>
    <mj-title>{{ t.email.test_failure_notification.title.text }}</mj-title>
    <mj-attributes>
      <mj-all font-family="Arial, Helvetica, sans-serif" font-size="16px" align="center" font-weight="bold" line-height="1.3" />
      {% if darkmode %}
      <mj-text color="#e6e6e6" />
      {% else %}
      <mj-text color="#000000" />
      {% endif %}
    </mj-attributes>
    <!-- Include styles from separate file -->
    <mj-include path="./components/email-styles.mjml" />
  </mj-head>
  <mj-body css-class="{% if darkmode %}dark-mode{% else %}light-mode{% endif %}">
    <!-- Header -->
    <mj-include path="./components/header.mjml" />
    
    <!-- Main Content -->
    <mj-wrapper css-class="content-box" padding="20px" padding-bottom="0">
      <mj-section>
        <mj-column>
          <mj-image width="50px" height="50px" src="icons/warning.png" align="center" css-class="email-icon-50" />
          <mj-text font-size="30px" padding-bottom="30px">
            <mark>{{ t.email.test_failure_notification.header.text }}</mark>
          </mj-text>
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.environment_label.text }}:</strong><br/>
            {{ environment }}
          </mj-text>
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.test_file_label.text }}:</strong><br/>
            {{ test_file }}
          </mj-text>
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.test_name_label.text }}:</strong><br/>
            {{ test_name }}
          </mj-text>
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.status_label.text }}:</strong><br/>
            <span style="color: {% if status == 'passed' %}#4CAF50{% elif status == 'failed' %}#F44336{% else %}#FF9800{% endif %};">{{ status | upper }}</span>
          </mj-text>
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.timestamp_label.text }}:</strong><br/>
            {{ timestamp }}
          </mj-text>
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.duration_label.text }}:</strong><br/>
            {{ duration_seconds }}s
          </mj-text>
          {% if error_message %}
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.error_label.text }}:</strong><br/>
            <pre style="background-color: {% if darkmode %}#2d2d2d{% else %}#f5f5f5{% endif %}; padding: 10px; border-radius: 4px; font-size: 12px; white-space: pre-wrap; word-wrap: break-word; text-align: left;">{{ error_message }}</pre>
          </mj-text>
          {% endif %}
          {% if console_logs %}
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.console_logs_label.text }}:</strong><br/>
            <pre style="background-color: {% if darkmode %}#2d2d2d{% else %}#f5f5f5{% endif %}; padding: 10px; border-radius: 4px; font-size: 11px; max-height: 300px; overflow-y: auto; white-space: pre-wrap; word-wrap: break-word; text-align: left;">{{ console_logs }}</pre>
          </mj-text>
          {% endif %}
          {% if network_activities %}
          <mj-text font-size="16px" padding-bottom="20px">
            <strong>{{ t.email.test_failure_notification.network_activities_label.text }}:</strong><br/>
            <pre style="background-color: {% if darkmode %}#2d2d2d{% else %}#f5f5f5{% endif %}; padding: 10px; border-radius: 4px; font-size: 11px; max-height: 300px; overflow-y: auto; white-space: pre-wrap; word-wrap: break-word; text-align: left;">{{ network_activities }}</pre>
          </mj-text>
          {% endif %}
          <mj-text font-size="14px" padding-bottom="30px" font-style="italic">
            {{ t.email.test_failure_notification.footer_note.text }}
          </mj-text>
        </mj-column>
      </mj-section>
    </mj-wrapper>
    
    <!-- Footer -->
    <mj-include path="./components/footer.mjml" />
  </mj-body>
</mjml>
